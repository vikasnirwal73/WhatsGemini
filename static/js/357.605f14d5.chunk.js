"use strict";(self.webpackChunkwhatsgemini=self.webpackChunkwhatsgemini||[]).push([[357],{357:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var r=a(43),s=a(315),l=a(204),o=a(543),n=a(579);const i=()=>{const[e,t]=(0,r.useState)((()=>{try{const e=localStorage.getItem(o.Qr);return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing initial messages from localStorage:",e),[]}}));(0,r.useEffect)((()=>{const a=e.filter((e=>""!==e.message.trim()));a.length&&a[0].role!==o.aw&&t((e=>[{...e[0],role:o.aw},...e.slice(1)])),localStorage.setItem(o.Qr,JSON.stringify(a))}),[e]);const a=(0,r.useCallback)(((e,a,r)=>{t((t=>t.map(((t,s)=>s===a?{...t,[r]:e}:t))))}),[]),s=(0,r.useCallback)((()=>{t((e=>[...e,{role:e.length%2===0?o.aw:o.AI,message:""}]))}),[]),i=(0,r.useCallback)((e=>{t((t=>t.filter(((t,a)=>a!==e))))}),[]);return(0,n.jsxs)("div",{className:"p-3",children:[(0,n.jsx)("label",{className:"block font-semibold mb-2 text-black dark:text-white mb-5",children:0===e.length?"Add a predefined system message":"Predefined System Messages (For new chats only)"}),e.map(((t,r)=>(0,n.jsxs)("div",{className:"mb-5 shadow-sm rounded-2xl bg-panel-light dark:bg-panel-dark border border-gray-200 dark:border-gray-800 flex flex-col gap-4 relative",children:[(0,n.jsxs)("select",{value:t.role,onChange:e=>a(e.target.value,r,"role"),className:"w-full p-3 bg-app-light dark:bg-app-dark text-black dark:text-white rounded-xl border border-transparent focus:border-primary outline-none transition-all",children:[(0,n.jsx)("option",{value:o.aw,children:"You"}),(0,n.jsx)("option",{value:o.AI,children:"Model"})]}),(0,n.jsx)("textarea",{value:t.message,onChange:e=>a(e.target.value,r,"message"),placeholder:"Enter a message that will be sent as the first message in any new chat...",className:"w-full p-3 bg-app-light dark:bg-app-dark text-black dark:text-white rounded-xl border border-transparent focus:border-primary outline-none transition-all"}),e.length>1&&(0,n.jsx)("button",{onClick:()=>i(r),className:"absolute -top-4 right-2 flex items-center justify-center bg-red-500 text-white hover:bg-red-600 w-8 h-8 rounded-full shadow-md transition-opacity hover:opacity-100 opacity-80 border-2 border-white dark:border-gray-800",children:(0,n.jsx)(l.qbC,{size:14})})]},r))),(0,n.jsxs)("button",{onClick:s,className:"mx-auto mt-4 flex items-center gap-2 bg-primary text-white px-4 py-2 rounded-full shadow-md hover:bg-primary-hover transition w-max",children:[(0,n.jsx)(l.OiG,{})," Add Message"]})]})},c=e=>{let{message:t,type:a="success",duration:s=5e3,onClose:o}=e;const[i,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=setTimeout((()=>{u(!0),setTimeout((()=>{c(!1),null===o||void 0===o||o()}),300)}),s);return()=>clearTimeout(e)}),[s,o]);if(!i)return null;const m="error"===a;return(0,n.jsxs)("div",{className:`toast ${d?"toast--leaving":""} ${m?"toast--error":"toast--success"}`,role:"alert",children:[(0,n.jsx)("div",{className:"toast__icon",children:m?(0,n.jsx)(l.TNq,{size:18}):(0,n.jsx)(l.A7C,{size:18})}),(0,n.jsx)("p",{className:"toast__message",children:t}),(0,n.jsx)("button",{onClick:()=>{u(!0),setTimeout((()=>{c(!1),null===o||void 0===o||o()}),300)},className:"toast__close","aria-label":"Close",children:(0,n.jsx)(l.QCr,{size:14})})]})},d=e=>{let{toasts:t,removeToast:a}=e;return(0,n.jsx)("div",{className:"toast-container",children:t.map((e=>(0,n.jsx)(c,{message:e.message,type:e.type,duration:e.duration,onClose:()=>a(e.id)},e.id)))})},u=()=>{const e=(0,s.Zp)(),[t,a]=(0,r.useState)(0),[c,u]=(0,r.useState)([]),[m,g]=(0,r.useState)((()=>{const e=localStorage.getItem(o.xW);return e&&!o.Jn.includes(e)?e:""})),[p,b]=(0,r.useState)(o.Jn.map((e=>({value:e,label:e}))));(0,r.useEffect)((()=>{(async()=>{const e=(()=>{try{return localStorage.getItem(o.N2)||null}catch(e){return console.error("Error retrieving API key:",e),null}})();if(e)try{const t=await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${e}`);if(!t.ok)throw new Error("Failed to fetch models");const a=(await t.json()).models.filter((e=>e.supportedGenerationMethods&&e.supportedGenerationMethods.includes("generateContent"))).map((e=>({value:e.name.replace("models/",""),label:e.displayName||e.name.replace("models/","")})));a.length>0&&b(a)}catch(t){console.error("Error fetching models:",t)}})()}),[]);const x=(e,t)=>{try{var a;return null!==(a=JSON.parse(localStorage.getItem(e)))&&void 0!==a?a:t}catch{return t}},[h,f]=(0,r.useState)((()=>{const e=localStorage.getItem(o.xW);return e&&o.Jn.includes(e)?e:o.Jn[0]})),[y,k]=(0,r.useState)(x(o.IW,o.rF)),[v,j]=(0,r.useState)(x(o.fD,o.uZ)),[w,N]=(0,r.useState)(x(o.o$,o.eX)),[S,C]=(0,r.useState)(x(o.jj,o.fc)),I=(0,r.useMemo)((()=>["Fine, I saved your precious settings. Happy now?","Settings saved. You're welcome, your majesty.","Wow, another setting change. Groundbreaking.","Saved! Not like I had anything better to do.","Settings updated. Try not to break anything.","Done. You sure do love clicking things.","Saved successfully. I'm so proud of you.","Changes saved. You're really keeping me busy today.","Got it. Any more demands, your highness?","Saved! That's definitely going to fix all your problems."]),[]),J=(0,r.useRef)(null),O=(0,r.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;const r=Date.now();u((s=>[...s,{id:r,message:e,type:t,duration:a}]))}),[]),M=(0,r.useCallback)((e=>{u((t=>t.filter((t=>t.id!==e))))}),[]);(0,r.useEffect)((()=>(J.current&&clearTimeout(J.current),J.current=setTimeout((()=>{try{const e=m.trim()||h;localStorage.setItem(o.xW,e),localStorage.setItem(o.IW,JSON.stringify(y)),localStorage.setItem(o.o$,JSON.stringify(w)),localStorage.setItem(o.jj,JSON.stringify(S)),localStorage.setItem(o.fD,JSON.stringify(v));const t=I[Math.floor(Math.random()*I.length)];O(t,"success")}catch(e){console.error("Error saving settings:",e),O("Failed to save settings. Please try again.","error")}}),1e3),()=>{J.current&&clearTimeout(J.current)})),[m,h,y,w,S,v,I,O]);const T=(0,r.useCallback)(((e,t)=>{C((a=>({...a,[e]:t})))}),[]),W=(0,r.useRef)(null),E=(0,r.useMemo)((()=>["harassment","hate_speech","sexual","dangerous"]),[]);return(0,n.jsxs)("div",{className:"w-full h-screen flex flex-col p-6 bg-app-light dark:bg-app-dark overflow-auto",children:[(0,n.jsxs)("button",{onClick:()=>{var t;const a=null===(t=window.history.state)||void 0===t?void 0:t.idx;"number"===typeof a&&a>0?e(-1):e("/",{replace:!0})},className:"mb-4 flex items-center gap-2 bg-primary text-white px-4 py-2 rounded-full shadow-md hover:bg-primary-hover transition w-max",children:[(0,n.jsx)(l.QVr,{size:16}),(0,n.jsx)("span",{children:"Back"})]}),(0,n.jsx)("h2",{className:"text-2xl font-bold mb-4 text-center text-primary dark:text-white",children:"Settings"}),(0,n.jsx)("p",{className:"text-center text-primary dark:text-white mb-4 text-sm",children:"Changes are saved automatically."}),(0,n.jsx)(d,{toasts:c,removeToast:M}),(0,n.jsxs)("div",{className:"w-full max-w-3xl mx-auto p-6 bg-panel-light dark:bg-panel-dark shadow-lg rounded-2xl mb-20",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 border-b border-gray-200 dark:border-gray-800 pb-6 mb-6",children:[(0,n.jsxs)("button",{onClick:()=>{const e={[o.xW]:m.trim()||h,[o.IW]:y,[o.o$]:w,[o.jj]:S,[o.fD]:v,[o.Qr]:JSON.parse(localStorage.getItem(o.Qr)||"[]")},t=JSON.stringify(e,null,2),a=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download="whatsgemini_settings.json",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)},className:"flex-1 bg-primary text-white py-2 px-4 rounded-lg hover:bg-primary-hover transition flex items-center justify-center gap-2",children:[(0,n.jsx)(l.WCW,{})," Export Settings"]}),(0,n.jsxs)("button",{onClick:()=>{W.current.click()},className:"flex-1 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition flex items-center justify-center gap-2",children:[(0,n.jsx)(l.HVe,{})," Import Settings"]}),(0,n.jsx)("input",{type:"file",ref:W,onChange:e=>{const t=e.target.files[0];if(!t)return;const r=new FileReader;r.onload=e=>{try{const t=JSON.parse(e.target.result);if(t[o.xW]){const e=t[o.xW];o.Jn.includes(e)?(f(e),g("")):g(e)}t[o.IW]&&k(t[o.IW]),t[o.o$]&&N(t[o.o$]),t[o.jj]&&C(t[o.jj]),t[o.fD]&&j(t[o.fD]),t[o.Qr]&&(localStorage.setItem(o.Qr,JSON.stringify(t[o.Qr])),a((e=>e+1))),O("Settings imported successfully!","success")}catch(t){console.error("Import error:",t),O("Failed to import settings. Invalid JSON file.","error")}},r.readAsText(t),e.target.value=null},accept:".json",style:{display:"none"}})]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[(0,n.jsx)("strong",{children:"Using Model:"})," ",m.trim()||h]}),(0,n.jsx)("label",{className:"block font-semibold mb-2 text-black dark:text-white",children:"Custom AI Model Name (optional)"}),(0,n.jsx)("input",{type:"text",placeholder:"Enter custom model name",value:m,onChange:e=>g(e.target.value),className:"w-full p-3 bg-app-light dark:bg-app-dark text-black dark:text-white rounded-xl border border-transparent focus:border-primary outline-none mb-4 transition-all"}),(0,n.jsx)("label",{className:"block font-semibold mb-2 text-black dark:text-white",children:"Or Select AI Model"}),(0,n.jsx)("select",{value:h,onChange:e=>f(e.target.value),className:"w-full p-3 bg-app-light dark:bg-app-dark text-black dark:text-white rounded-xl border border-transparent focus:border-primary outline-none mb-4 transition-all",children:p.map((e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value)))}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[(0,n.jsx)("strong",{children:"Selected Model:"})," ",m.trim()||h]}),(0,n.jsx)("label",{className:"block font-semibold mb-2 text-black dark:text-white",children:"Max Output Tokens"}),(0,n.jsx)("input",{type:"number",value:y,onChange:e=>k(Number(e.target.value)),className:"w-full p-3 bg-app-light dark:bg-app-dark text-black dark:text-white rounded-xl border border-transparent focus:border-primary outline-none mb-4 transition-all",min:"1"}),(0,n.jsx)("label",{className:"block font-semibold mb-2 text-black dark:text-white",children:"Max Chat Length (old messages will be deleted, 0 for unlimited length)"}),(0,n.jsx)("input",{type:"number",value:v,onChange:e=>j(Number(e.target.value)),className:"w-full p-3 bg-app-light dark:bg-app-dark text-black dark:text-white rounded-xl border border-transparent focus:border-primary outline-none mb-4 transition-all",min:"1"}),(0,n.jsx)("label",{className:"block font-semibold mb-2 text-black dark:text-white",children:"Temperature (Creativity Level)"}),(0,n.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",value:w,onChange:e=>N(Number(e.target.value)),className:"w-full mb-2"}),(0,n.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4",children:["Current: ",w]}),(0,n.jsx)("h3",{className:"font-semibold mb-2 text-black dark:text-white",children:"Safety Settings"}),E.map((e=>(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsxs)("label",{className:"block text-black dark:text-white capitalize mb-1",children:["Block ",e.replace("_"," ")]}),(0,n.jsx)("select",{value:S[e],onChange:t=>T(e,t.target.value),className:"w-full mb-2 p-2 bg-app-light dark:bg-app-dark text-black dark:text-white rounded-xl border border-transparent focus:border-primary outline-none transition-all",children:o.hR.map((e=>{let{label:t,value:a}=e;return(0,n.jsx)("option",{value:a,children:t},a)}))})]},e))),(0,n.jsx)(i,{},t)]})]})}}}]);
//# sourceMappingURL=357.605f14d5.chunk.js.map